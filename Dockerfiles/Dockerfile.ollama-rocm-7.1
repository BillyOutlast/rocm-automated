FROM docker.io/getterup/fedora-rocm7.1:latest
# vim: filetype=dockerfile


ARG FLAVOR=rocm
ARG PARALLEL=8

ARG ROCM7VERSION=7.1
ARG CMAKEVERSION=3.31.2

COPY ollama-build/ollama-src /ollama-src
COPY ollama-build/ollama-build-output/bin/ollama /usr/bin/ollama
COPY ollama-build/ollama-build-output/lib/ollama /usr/lib/ollama


# Set executable permissions and create rocm_v7 symlink
RUN chmod +x /usr/bin/ollama 

# Expose port
ENV OLLAMA_HOST=0.0.0.0:11434
EXPOSE 11434

ENTRYPOINT ["/usr/bin/ollama", "serve"]